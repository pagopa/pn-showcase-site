{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://gist.githubusercontent.com/StefanoFrontini/2edd2bb0e6e267a42dd6934526a881a3/raw/5f0391401dc1ff7434edc51ee16b2cdf45f53bde/dashboard-send-1-v4.json",
    "format": { "property": "perc_perfezionamento" }
  },
  "params": [{ "name": "year", "value": null }],
  "transform": [
    { "filter": "year == datum.year || year === +datum.year" },
    {
      "calculate": "datum.type_notification === 'ANALOG' ? 'Analogiche': 'Digitali'",
      "as": "type_notification_IT"
    }
  ],
  "height": { "step": 56 },
  "width": "container",
  "encoding": {
    "y": {
      "field": "type_notification_IT",
      "sort": {
        "field": "perc_perfezionamento",
        "order": "descending",
        "op": "sum"
      },
      "scale": { "padding": 0 },
      "axis": {
        "domain": false,
        "labelAlign": "left",
        "labelLimit": 0,
        "labelOffset": -20,
        "labelPadding": 0,
        "ticks": false
      }
    }
  },
  "layer": [
    {
      "mark": { "type": "bar", "height": 19 },
      "encoding": {
        "x": {
          "field": "perc_perfezionamento",
          "type": "quantitative",
          "aggregate": "sum",
          "axis": {
            "format": ".0%",
            "gridDash": [21, 35],
            "gridDashOffset": 38
          }
        }
      }
    },
    {
      "mark": { "type": "bar", "tooltip": true, "color": "transparent" },
      "encoding": {
        "tooltip": [
          { "field": "type_notification_IT", "title": "Modalit√† di invio" },
          {
            "field": "perc_perfezionamento",
            "aggregate": "sum",
            "title": "Percentuale",
            "format": ".0%"
          }
        ]
      }
    }
  ]
}
